<html>
  <head>
    <title>Maven Applications in production</title>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tabulator/3.3.3/css/tabulator.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tabulator/3.3.3/js/tabulator.min.js"></script>
    <style type="text/css">
    .tabulator {
      font-family: sans-serif;
    }
    </style>
    <script type="text/javascript">
    $(function() {
      $("#example-table").tabulator({
        initialSort:[
            {column:"title", dir:"asc"}
          ],
          //height:205, // set height of table, this enables the Virtual DOM and improves render speed dramatically (can be any valid css height value)
          layout:"fitColumns", //fit columns to width of table (optional)
          columns:[ //Define Table Columns
              {formatter:"rownum", align:"center", width:40},
        	  {title:"App Name", field:"title", headerFilter:"input"},
              {//create column group
                  title:"Artifact info",
                  columns:[
                      {title:"Group Id", field:"groupId", headerFilter:"input"},
                      {title:"Artifact Id", field:"artifactId", headerFilter:"input"},
                      {title:"Version", field:"version", width:125, headerFilter:"input", formatter:function(cell, formatterParams) {
                          var value = this.sanitizeHTML(cell.getValue());
                          var url = cell.getRow().getData()["nexusUrl"]
                          return "<a href='" + url + "'>" + this.emptyToSpace(value) + "</a>";
                       }},
                  ],
              },
               {title:"Source Control",
            	   columns:[
                 {title:"Project", field:"scmProject", width:100, headerFilter:"input"},
                 {title:"Repo", field:"scmRepo", headerFilter:"input"},
                 {title:"Hash", field:"hashOrTag", width:75, formatter:function(cell, formatterParams) {
                     var value = this.sanitizeHTML(cell.getValue());
                     var url = cell.getRow().getData()["scmUrl"]
                     return "<a href='" + url + "'>" + this.emptyToSpace(value) + "</a>";
                  }}
               ]
               },
               {title:"CVE Security Issues",
            	   columns:[
            		 {title:"High", field:"cveSeverityCountHigh", headerFilter:"input", width:50, formatter:function(cell, formatterParams) {
                           var value = this.sanitizeHTML(cell.getValue());
                           var url = cell.getRow().getData()["owaspDependencyCheckUrl"]
                           return "<a href='" + url + "'>" + this.emptyToSpace(value) + "</a>";
                  }},
                  {title:"Medium", field:"cveSeverityCountMedium", headerFilter:"input", width:50, formatter:function(cell, formatterParams) {
                      var value = this.sanitizeHTML(cell.getValue());
                      var url = cell.getRow().getData()["owaspDependencyCheckUrl"]
                      return "<a href='" + url + "'>" + this.emptyToSpace(value) + "</a>";
                   }},
                 {title:"Low", field:"cveSeverityCountLow", headerFilter:"input", width:50, formatter:function(cell, formatterParams) {
                     var value = this.sanitizeHTML(cell.getValue());
                     var url = cell.getRow().getData()["owaspDependencyCheckUrl"]
                     return "<a href='" + url + "'>" + this.emptyToSpace(value) + "</a>";
                  }}
               ]
               },
              {title:"Java 8 Ready", field:"java8Ready", headerFilter:"input", width:100, formatter:function(cell, formatterParams) {
                  var value = this.sanitizeHTML(cell.getValue());
                  var url = cell.getRow().getData()["java8Url"]
                  return "<a href='" + url + "'>" + this.emptyToSpace(value) + "</a>";
               }},
               {title:"JIRA", field:"jiraKey", headerFilter:"input", width:120, formatter:function(cell, formatterParams) {
                  var value = this.sanitizeHTML(cell.getValue());
                  var url = cell.getRow().getData()["jiraUrl"]
                  return "<a href='" + url + "'>" + this.emptyToSpace(value) + "</a>";
               }},
               {title:"Deployment",
            	   columns:[
            		   {title:"Name", field:"deploymentName", headerFilter:"input"},
            		   {title:"Cluster", field:"cluster", headerFilter:"input"},
            		   {title:"Nodes", field:"nodes", headerFilter:"input"},
            		   {title:"Public", field:"public", headerFilter:"input", formatter:"tick", width:50},
            		   {title:"Url", field:"applicationUrl", width:50, formatter:function(cell, formatterParams) {
                           var value = this.sanitizeHTML(cell.getValue());
                           var url = cell.getRow().getData()["applicationUrl"]
                           if (url) {
                             return "<a href='" + url + "'>url</a>";
                           } else {
                             return "";
                           }
                    }}
               ]
               },
              {title:"Build Date", field:"buildDateFormatted", width:100, headerFilter:"input"},
          ],
          rowClick:function(e, row){ //trigger an alert message when the row is clicked
              //alert("Row " + row.getData().id + " Clicked!!!!");
          },
      });
       
      $("#groupBy").change(function(){
         $("#example-table").tabulator("groupBy", this['value']);
      });
  
      //load sample data into the table
      $("#example-table").tabulator("setData", "app-inventory.json");
    });
    </script>
  </head>
  <body>
    <h1>Maven Applications in production</h1>
    <p>Only applications that have source control information information will have accurate CVE or java 8 results</p>
    <form action="#">
       <label for="groupBy">Group items by</label>
       <select name="groupBy" id="groupBy">
         <option value="">No grouping</option>
         <option value="cluster">Cluster</option>
         <option value="nodes">Nodes</option>
         <option value="public">Public / Intranet</option>
       </select>
    </form>
    <div id="example-table"></div>
  </body>
</html>